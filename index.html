<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mattington's Marvelous Adventure!</title>
<link rel="stylesheet" href="./styleA.css">
<script src="./js/myFuncts.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<!-- leave what is repeatable for now -->
<!-- Sometimes when I comment things out, a 
    linter tries to use "hidden" braces and screw with my code -->
<body>
<!-- <button onclick="showHide()">This button used to swap views</button> -->
<div id="counter">1</div>


<script>
    document.addEventListener("DOMContentLoaded", () => {
        //load Artists
        const artistURL = "starting-files/artists.json";
        const artistSel = document.querySelector("#artistSearch");

        //Now Fetching Artists
        fetch(artistURL)
            .then(response => response.json())
            .then(data => { populateArtists(data) })
        const optArt = document.createElement("option");
        optArt.textContent = "Pick an Artist";
        optArt.value = 0;
        artistSel.appendChild(optArt);

        function populateArtists(artistData) {
            for (let art of artistData) {
                const optA = document.createElement("option");
                optA.textContent = art.name;
                optA.id = art.id;
                optA.type = art.type;
                artistSel.appendChild(optA);

            }
        }
        artistSel.onclick = function (e) {
            if (e.target.tagName.toLowerCase() === 'option') {
                loadSongs();
            }
        }
    });
        function loadSongs() {
            const songURL = "starting-files/sample-songs.json";
            const songSel = document.querySelector("#songSearch")

            fetch(songURL)
                .then(response => response.json())
                .then(data => { populateSongs(data) })
            const opt1 = document.createElement("option");
            opt1.textContent = "Pick a Song";
            opt1.value = 0;
            songSel.appendChild(opt1);

            function populateSongs(songData) {
                for (let s of songData) {
                    const optS = document.createElement("option");
                    optS.textContent = s.title;
                    optS.songID = s.song_id;
                    optS.title = s.title;
                    optS.year = s.year;
                    optS.artistID = s.artist.id;
                    optS.artist = s.artist.name;
                    optS.genreID = s.genre.id;
                    optS.genre = s.genre.name;
                    optS.durationInSec = s.details.duration;
                    optS.bpm = s.details.bpm;
                    optS.popul = s.details.popularity;
                    optS.loudness = s.details.loudness;
                    optS.energy = s.analytics.energy;
                    optS.danceability = s.analytics.danceability;
                    optS.liveness = s.analytics.liveness;
                    optS.valence = s.analytics.valence;
                    optS.acousticness = s.analytics.acousticness;
                    optS.speechiness = s.analytics.speechiness;
                    songSel.appendChild(optS);
                }
            }
            songSel.onclick = function (e) {
                if (e.target.tagName.toLowerCase() === 'option') {
                    console.log(e.target.title + ' clicked');

                    // loadResults(e.target);
                    //pass in the song-object for the browse/search
                    songsDisplayed(e.target);
                    //takes you to selected song info
                    const charti = document.querySelector("#right3");
                    charti.style.display = "block";
                    // const searchi = document.querySelector("#left1");
                    // searchi.style.display = "none";
                    makeChart(e.target);
                }
            }
        }


    function showHide() {
        let x = document.querySelector("#search-view");
        let y = document.querySelector("#song-view");
        let z = document.querySelector("#playlist-view");
//Should flip between views
//well, it had worked but I borked it up something fierce
    }
</script>

<div class="displayer" id="search-view"> <!-- SongSearchView -->
<header id="head0">
    <h1>Songs n Stuff</h1>
    <!-- Title to be dynamic later -->
<button id="playlistBTN">.onClick(GoToPlaylist())</button>
<button id="repoBtn" onClick="goToRepo()"> :onClick(goToRepo()) + :mouseover(CREDITS())</button>
</header>

<!-- These sections will be replaced as the user does the navigating -->
<section id="left1">
    <h1>Basic Search</h1>
<!-- <form id="search-form" action="">
<p>Search type:</p>
<input type="radio" name="search-options" id="search-title">
<label for="search-title">Song Title ${all.the.titles}(Dropdown)</label><br>
<input type="radio" name="search-options" id="search-artist">
<label for="search-options">Artist Name ${all.the.artists}</label><br>
<input type="radio" name="search-options" id="search-genre">
<label for="search-options">Genre ${all.the.genres}</label><br>
<br>
<input type="submit" value="Submit">
<input type="reset" value="Clear">
</form> -->

<div id="searcher">
    <select name="artistSearch" id="artistSearch" textContext="Pick"></select>
    <select name="songSearch" id="songSearch"></select>
</div>
</section>
<!-- this will be for that searchform once it's fully functional -->


<!-- <section id="centre2">
<h1>Browse/Search Results</h1>

<table id="resultsDisplay">
    <tr>
<th>Title</th>
<th>Artist</th>
<th>Year</th>
<th>Genre</th>
<th>Popularity</th>
<th>Button</th>
</tr>
</table>

</section> -->

<section id="centre2">
    <h2>Song Information</h2>
    <div id="songInfos"></div>

    <h2>Analysis of Data</h2>
    <ul id="analysisData"></ul>
</section>
<section style="display:none" id="right3">

    <div style="display:block">
        <canvas id="myChart"> Chart: Exists but doesn't response to anything, yet</canvas>
    </div>
    <!-- Chart Base from: (https://www.chartjs.org) -->
    <div id="theChartBox1">
        <div>
            <canvas id="myChart"></canvas>
        </div>




    </div>
</section>
</div>

<div class="displayer" id="song-view"> <!-- SingleSongView -->
    <header id="head0">
        <h1>$SingleSongView</h1>
        <button>.onClick(GoToPlaylist)</button>
        <button>.onClick(GoToRepo) + :mouseover(CREDITS!)</button>
        <button>.onlick(ToGoSearchBrowse) CLOSE</button>
    </header>


<section id="left1">
    <h2>Song Information</h2>
    <!-- How to get this from the user. ex, use thier selection to load this -->
    <p>$song.title, $song.artist, $song.artist_type, $song.genre, $song.duration(in mins+secs)</p>

<ul>
    <!-- (THIS IS WHERE WE WILL ADD JSON/API INFO ONCE WE GOT IT) -->
    <h2>Analysis Data</h2>
    </ul>



</section>

<section id="centre2">

<div style="display: block" ;>
    s <canvas id="myChart"> Chart: Exists but doesn't response to anything, yet</canvas>
</div>
<!-- Chart Base from: (https://www.chartjs.org) -->
<!-- <div id="theChartBox">
<div>
<canvas id="myChart"></canvas>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
const ctx2 = document.querySelector("#myChart");

new Chart(ctx2, {
type: 'radar',
data: {
labels: [
'BPM',
'Energy',
'Danciness',
'Valance',
'Acousticness',
'Speechiness',
'Popularity'
],
// (THIS IS WHERE WE WILL ADD THE JSON/API INFO ONCE WE GOT IT)
datasets: [{
label: '# OF DATA POINTS',
data: [82, 59, 84, 41, 56, 52, 70],
// data: [$song.bpm, $song.energy, $song.danceiness, $song.valance,
// $song.acousticness, $song.speechiness, $song.popularity],
borderWidth: 1
}]

},
options: {

elements: {
line: {
borderWidth: 3
}
},
scales: {
r: {
angleLines: {
display: false
},
suggestedMin: 20,
suggestedMax: 100
}
}
},
});
</script>
</div> -->
</section>

</div>

<div class="displayer" id="playlist-view"> <!-- PlaylistView -->
    <header id="head0">
        <h1>$PlaylistView</h1>
        <!-- <button>.onClick(GoToPlaylist)</button> -->
        <button>.onClick(GoToRepo) + :mouseover(CREDITS!)</button>
        <button>.onlick(ToGoSearchBrowse) CLOSE</button>
    </header>

<section id="left1">
    <div>
        <h1>Playlist Details</h1>
        <p>${#ofsongsinlist}</p>
        <p>${popularityrankings?}</p>
    </div>

<table>
    <tr>
        <th>Title
            <!-- <div id="sortButtons">
<button id="sortASC" onClick="sortResultsAsc()">ASC</button>
<button id="sortDSC" onClick="sortResultsDsc()">DSC</button>
</div> -->
        </th>
        <th>Artist</th>
        <th>Year</th>
        <th>Genre</th>
        <th>Popularity</th>
        <th>""</th>
    </tr>
    <!-- forEachEntryinPlaylist -->
    <!-- createElement("<tr>");
createElement("<td><a href="goToSongPage($t)">")
createElement("</a></td>")
createElement("<td>a")
createElement("</a></td>") -->
    <tr>
        <td>1</td>
        <td>2</td>
        <td>3</td>
        <td>4</td>
        <td>5</td>
        <td><button>RMV</button></td>
    </tr>
    <!-- Endof"Loop" -->
</table>

</section>

<section id="centre2">

</section>
</div>

<footer>
    <h2>FOOTER</h2>
</footer>
</body>
<!-- Putting Scripts Here -->

<!-- Putting Styles Here -->

</html>